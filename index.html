<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>çŒ«ã®æ—¥ã‚ãã‚Šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .calendar-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 500px;
      width: 100%;
      overflow: hidden;
    }

    .calendar-header {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      padding: 30px;
      text-align: center;
      color: white;
    }

    .date-display {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .day-number {
      font-size: 72px;
      font-weight: bold;
      line-height: 1;
      margin: 10px 0;
    }

    .year-month {
      font-size: 18px;
      opacity: 0.9;
    }

    .cat-image-container {
      position: relative;
      width: 100%;
      height: 400px;
      background: #f5f5f5;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .cat-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: none;
    }

    .cat-image.loaded {
      display: block;
    }

    .loading {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    .loading.hidden {
      display: none;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .loading-text {
      color: #666;
      font-size: 16px;
    }

    .calendar-footer {
      padding: 25px;
      text-align: center;
      background: #fafafa;
    }

    .refresh-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 40px;
      border-radius: 30px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .refresh-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    .refresh-button:active {
      transform: translateY(0);
    }

    .info-text {
      margin-top: 15px;
      color: #999;
      font-size: 14px;
    }

    .paw-print {
      display: inline-block;
      margin: 0 5px;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-5px);
      }
    }

    @media (max-width: 600px) {
      .day-number {
        font-size: 56px;
      }

      .cat-image-container {
        height: 300px;
      }
    }
  </style>
</head>

<body>
  <div class="calendar-container">
    <div class="calendar-header">
      <div class="date-display">ä»Šæ—¥ã®çŒ«</div>
      <div class="day-number" id="dayNumber"></div>
      <div class="year-month" id="yearMonth"></div>
    </div>

    <div class="cat-image-container">
      <div class="loading" id="loading">
        <div class="spinner"></div>
        <div class="loading-text">çŒ«ã¡ã‚ƒã‚“ã‚’æ¢ã—ã¦ã„ã¾ã™...</div>
      </div>
      <img class="cat-image" id="catImage" alt="ä»Šæ—¥ã®çŒ«">
    </div>

    <div class="calendar-footer">
      <button class="refresh-button" id="refreshButton">
        ğŸ± æ–°ã—ã„çŒ«ã¡ã‚ƒã‚“ã‚’è¦‹ã‚‹
      </button>
      <div class="info-text">
        <span class="paw-print">ğŸ¾</span>
        æ¯æ—¥é•ã†çŒ«ã«ä¼šãˆã¾ã™
        <span class="paw-print">ğŸ¾</span>
      </div>
    </div>
  </div>

  <script>
    // æ—¥ä»˜ã‚’è¡¨ç¤º
    function updateDate() {
      const now = new Date();
      const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
      const dayOfWeek = days[now.getDay()];

      document.getElementById('dayNumber').textContent = now.getDate();
      document.getElementById('yearMonth').textContent =
        `${now.getFullYear()}å¹´ ${now.getMonth() + 1}æœˆ (${dayOfWeek})`;
    }

    // çŒ«ã®ç”»åƒã‚’èª­ã¿è¾¼ã¿
    async function loadCatImage() {
      const loading = document.getElementById('loading');
      const catImage = document.getElementById('catImage');

      // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
      loading.classList.remove('hidden');
      catImage.classList.remove('loaded');

      try {
        // The Cat APIï¼ˆç„¡æ–™ãƒ»å®‰å…¨ï¼‰ã‹ã‚‰ç”»åƒã‚’å–å¾—
        const response = await fetch('https://api.thecatapi.com/v1/images/search');
        const data = await response.json();

        if (data && data[0] && data[0].url) {
          const imageUrl = data[0].url;

          // ç”»åƒã‚’äº‹å‰èª­ã¿è¾¼ã¿
          const img = new Image();
          img.onload = () => {
            catImage.src = imageUrl;
            catImage.classList.add('loaded');
            loading.classList.add('hidden');
          };
          img.onerror = () => {
            console.error('ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
            loading.querySelector('.loading-text').textContent =
              'ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚';
          };
          img.src = imageUrl;
        }
      } catch (error) {
        console.error('ã‚¨ãƒ©ãƒ¼:', error);
        loading.querySelector('.loading-text').textContent =
          'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚';
      }
    }

    // æ—¥ä»˜ã«åŸºã¥ã„ã¦åŒã˜çŒ«ã‚’è¡¨ç¤ºï¼ˆãã®æ—¥ã®çŒ«ã‚’å›ºå®šï¼‰
    async function loadDailyCat() {
      const today = new Date();
      const dateString = `${today.getFullYear()}-${today.getMonth() + 1}-${today.getDate()}`;

      // ä»Šæ—¥ã®çŒ«ãŒæ—¢ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
      const savedCat = localStorage.getItem('dailyCat');
      const savedDate = localStorage.getItem('dailyCatDate');

      if (savedCat && savedDate === dateString) {
        // ä»Šæ—¥ã®çŒ«ãŒæ—¢ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯è¡¨ç¤º
        const catImage = document.getElementById('catImage');
        const loading = document.getElementById('loading');

        const img = new Image();
        img.onload = () => {
          catImage.src = savedCat;
          catImage.classList.add('loaded');
          loading.classList.add('hidden');
        };
        img.src = savedCat;
      } else {
        // æ–°ã—ã„æ—¥ãªã®ã§æ–°ã—ã„çŒ«ã‚’å–å¾—
        try {
          const response = await fetch('https://api.thecatapi.com/v1/images/search');
          const data = await response.json();

          if (data && data[0] && data[0].url) {
            const imageUrl = data[0].url;

            // ä»Šæ—¥ã®çŒ«ã¨ã—ã¦ä¿å­˜
            localStorage.setItem('dailyCat', imageUrl);
            localStorage.setItem('dailyCatDate', dateString);

            const catImage = document.getElementById('catImage');
            const loading = document.getElementById('loading');

            const img = new Image();
            img.onload = () => {
              catImage.src = imageUrl;
              catImage.classList.add('loaded');
              loading.classList.add('hidden');
            };
            img.src = imageUrl;
          }
        } catch (error) {
          console.error('ã‚¨ãƒ©ãƒ¼:', error);
          document.getElementById('loading').querySelector('.loading-text').textContent =
            'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚';
        }
      }
    }

    // åˆæœŸåŒ–
    updateDate();
    loadDailyCat();

    // æ›´æ–°ãƒœã‚¿ãƒ³
    document.getElementById('refreshButton').addEventListener('click', loadCatImage);

    // æ—¥ä»˜ãŒå¤‰ã‚ã£ãŸã‚‰è‡ªå‹•æ›´æ–°ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
    setInterval(() => {
      const now = new Date();
      if (now.getHours() === 0 && now.getMinutes() === 0) {
        updateDate();
        loadDailyCat();
      }
    }, 60000); // 1åˆ†ã”ã¨ã«ãƒã‚§ãƒƒã‚¯
  </script>
</body>

</html>